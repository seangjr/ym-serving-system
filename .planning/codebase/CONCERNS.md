# Codebase Concerns

**Analysis Date:** 2026-02-13

## Early-Stage Project Structure

**Project Status:**
- **Issue:** This is a freshly scaffolded Next.js 16 application with minimal production code
- **Files affected:** `app/page.tsx`, `app/layout.tsx`
- **Impact:** Boilerplate default content still in place; no business logic implemented
- **Fix approach:** Plan feature development phases using `/gsd:plan-phase` before implementing; establish architectural patterns now to avoid rework

**Current limitations:**
- Single home page with create-next-app default template content
- No API routes, database, or backend services configured
- No authentication or authorization system in place
- No environmental configuration beyond defaults

---

## Missing Test Infrastructure

**No Test Framework Configured:**
- **Problem:** Zero test files found; no Jest, Vitest, or other test runners configured
- **Files affected:** Project-wide (entire `app/` and `components/` directories untested)
- **Risk:** High — Components can be modified with no safety net; UI regressions undetectable
- **Priority:** High — Should be configured before substantial feature development
- **Fix approach:**
  - Set up Vitest for unit/component testing (preferred for Next.js)
  - Configure test files co-located with source (e.g., `button.test.tsx` alongside `button.tsx`)
  - Add coverage thresholds to prevent untested code from shipping

**Coverage gaps:**
- UI component library in `components/ui/` has 58 files with zero test coverage
- Hook in `hooks/use-mobile.ts` has no tests for responsive behavior
- Utility function in `lib/utils.ts` (cn() function) has no tests

---

## Untested UI Component Library

**Large Component Set Without Tests:**
- **Problem:** 58 pre-built shadcn components added but no tests to verify their functionality
- **Files affected:** `components/ui/*.tsx` (all files)
- **Risk:** Components may have accessibility issues, prop validation bugs, or style regressions
- **Safe modification:** Test-first approach when making changes; document expected behavior before modifying
- **Test coverage:** 0/58 components have explicit tests

**Known component complexity:**
- `components/ui/alert-dialog.tsx` — 196 lines with complex className logic and animation states
- `components/ui/pagination.tsx` — 127 lines with navigation logic
- No documentation of which components are fully tested upstream (from shadcn)

---

## Metadata Inconsistency

**Outdated Page Metadata:**
- **Issue:** `app/layout.tsx` has default create-next-app metadata
- **Files affected:** `app/layout.tsx` (lines 15-18)
- **Current value:**
  ```typescript
  title: "Create Next App"
  description: "Generated by create next app"
  ```
- **Impact:** Low (cosmetic only) but reduces professionalism; poor SEO signal
- **Fix approach:** Replace with actual project metadata: "YM Serving System" and project description

---

## Dependency Maintenance Concerns

**Deprecated Dependency Present:**
- **Issue:** `domexception` package is deprecated with message "Use your platform's native DOMException instead"
- **Location:** In `pnpm-lock.yaml` dependencies
- **Impact:** Low (not directly used in application code); transitive dependency
- **Fix approach:** Update dependents to remove reliance on domexception; check with `pnpm audit`

**Mixed Package Manager History:**
- **Issue:** README.md lists npm, yarn, pnpm, and bun as valid package managers, but project uses pnpm exclusively
- **Files affected:** `README.md`, `package.json` scripts
- **Impact:** Low but confusing — developers might try wrong package manager
- **Fix approach:** Update README to specify pnpm only; simplify setup instructions

---

## TypeScript Configuration Strictness

**Strict Mode Enabled Correctly:**
- **Current state:** `tsconfig.json` has `"strict": true` — good
- **All type definitions in place:** `@types/node`, `@types/react`, `@types/react-dom` present
- **No type-safety workarounds found:** No `any`, `@ts-ignore`, or `@ts-expect-error` comments detected

---

## CSS-in-JS Volume and Maintainability

**Very Large Tailwind CSS Classnames:**
- **Problem:** Some components have extremely long className attributes that are hard to read and maintain
- **Example:** `components/ui/alert-dialog.tsx` line 78:
  ```typescript
  "grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-6 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left..."
  ```
- **Files affected:** Multiple shadcn UI components (`alert-dialog.tsx`, `tabs.tsx`, `pagination.tsx`)
- **Impact:** Medium — Hard to review diffs, difficult to debug styling issues, prone to accidental changes
- **Safe modification:** Use Tailwind v4 `@layer` utilities for complex, repeated patterns
- **Fix approach:** Consider extracting complex classname expressions into CSS utility classes in `app/globals.css`

---

## Empty Next.js Configuration

**Minimal Configuration:**
- **File:** `next.config.ts`
- **Current state:** Config object present but completely empty (`/* config options here */`)
- **Impact:** Low — Works fine for early-stage app; will need configuration as project grows
- **Future needs to plan:**
  - Image optimization rules (webpack loader config if using non-Next Image)
  - API request rewrites or proxies (if backend lives elsewhere)
  - Environment variable exposure (publicRuntimeConfig, serverRuntimeConfig)
  - Build optimizations (when needed)

---

## Hook with Hydration Caveat

**useIsMobile Hook Hydration Issue:**
- **File:** `hooks/use-mobile.ts`
- **Issue:** Returns `undefined` on initial render (before useEffect runs), then updates state
- **Code pattern (lines 8-18):**
  ```typescript
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)
  React.useEffect(() => {
    // ... initialize after mount
  }, [])
  return !!isMobile  // False until hydrated
  ```
- **Impact:** Medium — Can cause hydration mismatches in server-rendered content
- **Safe usage:** Only use in client components (`"use client"`); never use to conditionally render critical layout in server components
- **Recommendation:** Document this caveat; consider returning initial value from media query synchronously if possible

---

## Console Output Logging

**No Debug Logging Found:**
- **Current state:** No `console.log`, `console.error`, or debug statements detected in application code
- **Impact:** Good for production; may make debugging during development harder
- **Recommendation:** When adding features, consider structured logging (e.g., Winston, Pino) rather than console

---

## Tailwind CSS v4 Migration

**Uses Tailwind v4 with `@import` Syntax:**
- **File:** `app/globals.css`
- **Pattern:** Modern v4 syntax with `@import "tailwindcss"` and `@theme inline`
- **Status:** Correct implementation; no compatibility issues detected
- **Configuration:** `tailwindcss.config.js` not present (v4 uses `@theme` in CSS)
- **Awareness:** Ensure all future Tailwind utilities use v4 syntax, not v3

---

## Missing Backend/API Layer

**No API Routes or Backend Code:**
- **Issue:** Project has no `app/api/` routes, no database client, no authentication
- **Files affected:** Entire project
- **Impact:** High — Major features cannot be implemented without this infrastructure
- **Fix approach:**
  - Plan API layer design in `/gsd:plan-phase` (consider REST vs GraphQL)
  - Set up database connection (Postgres + Supabase, or alternative)
  - Implement authentication (NextAuth.js or Auth0)
  - Create API routes under `app/api/` following Next.js conventions

---

## Documentation and Project Metadata

**Minimal Project Documentation:**
- **Issue:** `README.md` contains only boilerplate create-next-app content; no project context or setup instructions
- **Files affected:** `README.md`
- **Impact:** Medium — New developers cannot understand project purpose or architecture
- **Already documented:** Project purpose exists in `CLAUDE.md` (internal reference for Claude Code)
- **Fix approach:** Update README.md with:
  - Project purpose: "YM Serving System — a [description]"
  - Local setup instructions (pnpm install, pnpm dev)
  - Architecture overview
  - Feature list or roadmap

---

## Version Pinning and Semver Risk

**Minor Version Ranges in package.json:**
- **Current approach:** Using `^` semver ranges (e.g., `^16.1.6` for Next.js)
- **Risk:** Medium — Minor version updates can introduce breaking changes in some packages
- **Examples:**
  - `next: "^16.1.6"` — Could auto-update to 16.99.x with API changes
  - `react: "19.2.3"` (strict) — Good, pinned to specific version
  - `@tailwindcss/postcss: "^4"` — Could update to 4.99.x with new behavior
- **Recommendation:** Consider using `~` for framework versions (patch updates only) until major releases stabilize
- **Current lock:** `pnpm-lock.yaml` prevents auto-updates, but consider explicit policy

---

## Summary of Priority Actions

| Concern | Priority | Time to Fix | Blocks Shipping |
|---------|----------|-------------|-----------------|
| No test infrastructure | High | 2-4 hours | No, but risky |
| Outdated metadata | Low | 30 mins | No |
| Missing API layer | High | Planning phase | Yes |
| Component library untested | High | Ongoing | No |
| Deprecated domexception | Low | 1 hour | No |
| Metadata in README | Medium | 1 hour | No |
| Hook hydration documentation | Low | 30 mins | No |
| CSS classname complexity | Medium | Ongoing | No |

---

*Concerns audit: 2026-02-13*
