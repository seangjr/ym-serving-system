---
phase: 02-teams-and-member-profiles
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/auth/roles.ts
  - components/app-sidebar.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Teams and Team Roster links appear in sidebar navigation for admin/committee roles"
    - "My Profile is accessible from user avatar dropdown at bottom of sidebar, not as a regular nav item"
  artifacts:
    - path: "lib/auth/roles.ts"
      provides: "Navigation items with Teams and Team Roster for admin/committee; no My Profile nav item"
    - path: "components/app-sidebar.tsx"
      provides: "Sidebar renders Teams/Team Roster links; user dropdown includes My Profile link"
  key_links:
    - from: "components/app-sidebar.tsx"
      to: "lib/auth/roles.ts"
      via: "getNavItems(role)"
      pattern: "getNavItems"
---

<objective>
Fix sidebar navigation: add missing Teams and Team Roster links, and move My Profile from sidebar nav to user avatar dropdown menu.

Purpose: Close Gap 1 (MAJOR) and Gap 5 (minor) from UAT — teams page unreachable from sidebar, and profile should be in user menu not nav.
Output: Updated sidebar with correct navigation items and profile accessible from user dropdown.
</objective>

<execution_context>
@/Users/chungweijian/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chungweijian/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@lib/auth/roles.ts
@components/app-sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update navigation items and move profile to user dropdown</name>
  <files>lib/auth/roles.ts, components/app-sidebar.tsx</files>
  <action>
    **In `lib/auth/roles.ts`:**
    1. Add "Teams" nav item (`{ title: "Teams", href: "/teams", icon: "Users" }`) to `ADMIN_NAV_ITEMS` — insert it after "Services" (Dashboard). Use icon name "FolderOpen" is taken, use a different icon. Actually, "Users" is already used for Team Roster. Use "UsersRound" for Teams (Lucide icon name). Wait — need to check what icons exist. Actually just use distinct names:
       - Teams: `{ title: "Teams", href: "/teams", icon: "Users" }` — rename the existing Team Roster icon
       - Team Roster: keep `{ title: "Team Roster", href: "/team-roster", icon: "Users" }` — already exists!

       Looking at existing ADMIN_NAV_ITEMS: it already has Team Roster. The issue is Teams `/teams` is MISSING. Add it.

       Add `{ title: "Teams", href: "/teams", icon: "FolderOpen" }` after Team Roster. Actually, let's use a group icon. Use "Layers" for Teams (representing team layers/groups).

       Final nav order for ADMIN_NAV_ITEMS:
       ```
       Services (/dashboard) - Calendar
       Teams (/teams) - Layers
       Team Roster (/team-roster) - Users
       Songs (/songs) - Music
       Announcements (/announcements) - Megaphone
       Equipment (/equipment) - Wrench
       Reports (/reports) - BarChart3
       Files (/files) - FolderOpen
       ```

       Remove "My Profile" from ADMIN_NAV_ITEMS (it will go in user dropdown).
       Remove "My Profile" from MEMBER_NAV_ITEMS too.

    2. In `getNavItems()`, the Admin gets ADMIN_NAV_ITEMS + Admin link. Committee gets ADMIN_NAV_ITEMS. Member gets MEMBER_NAV_ITEMS. All WITHOUT My Profile as a nav item.

    **In `components/app-sidebar.tsx`:**
    1. Import `Layers` and `UserCircle` from lucide-react (add Layers to ICON_MAP).
    2. In the user dropdown menu (SidebarFooter), add a "My Profile" link between the user label and theme options:
       ```tsx
       <DropdownMenuGroup>
         <DropdownMenuItem asChild>
           <Link href="/profile">
             <UserCircle className="size-4" />
             My Profile
           </Link>
         </DropdownMenuItem>
       </DropdownMenuGroup>
       <DropdownMenuSeparator />
       ```
       Place this after the DropdownMenuLabel section and before the theme group.
    3. Add "Layers" to the ICON_MAP: `Layers` imported from lucide-react.
  </action>
  <verify>
    Run `pnpm build` — no TypeScript errors. Visually confirm:
    - ADMIN_NAV_ITEMS has 8 items (Services, Teams, Team Roster, Songs, Announcements, Equipment, Reports, Files) — no My Profile.
    - MEMBER_NAV_ITEMS has 4 items (My Schedule, Songs, Announcements, Files) — no My Profile.
    - User dropdown in sidebar footer has "My Profile" link before theme options.
  </verify>
  <done>
    Teams and Team Roster appear in sidebar for admin/committee. My Profile is in user dropdown (bottom-left), not in sidebar nav.
  </done>
</task>

</tasks>

<verification>
1. `pnpm build` completes without errors
2. Sidebar nav for admin shows: Services, Teams, Team Roster, Songs, Announcements, Equipment, Reports, Files, Admin
3. Sidebar nav for member shows: My Schedule, Songs, Announcements, Files
4. My Profile is NOT in sidebar nav for any role
5. User dropdown menu at bottom of sidebar includes "My Profile" link that navigates to /profile
</verification>

<success_criteria>
- Teams page (/teams) reachable from sidebar for admin and committee roles
- Team Roster page (/team-roster) reachable from sidebar for admin and committee roles
- My Profile accessible from user avatar dropdown at bottom-left of sidebar, not as regular nav item
- No TypeScript or build errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-teams-and-member-profiles/02-05-SUMMARY.md`
</output>
