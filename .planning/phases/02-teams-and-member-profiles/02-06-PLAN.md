---
phase: 02-teams-and-member-profiles
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - app/(app)/team-roster/page.tsx
  - components/teams/roster-member-card.tsx
  - components/teams/team-member-list.tsx
  - components/teams/position-manager.tsx
  - lib/teams/schemas.ts
  - lib/teams/actions.ts
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Team roster page uses table layout on desktop and card layout on mobile"
    - "Edit Skills dialog has clear labeling explaining what proficiency and preference mean"
    - "Position create/edit forms do not show quantity_needed field"
  artifacts:
    - path: "app/(app)/team-roster/page.tsx"
      provides: "Responsive roster: table on desktop (md+), card grid on mobile"
    - path: "components/teams/roster-member-card.tsx"
      provides: "Card component for mobile roster view"
    - path: "components/teams/team-member-list.tsx"
      provides: "Improved SkillEditDialog with descriptive labels"
    - path: "components/teams/position-manager.tsx"
      provides: "Position forms without quantity_needed field"
    - path: "lib/teams/schemas.ts"
      provides: "Position schemas with optional quantityNeeded (backward compatible)"
  key_links:
    - from: "app/(app)/team-roster/page.tsx"
      to: "components/teams/roster-member-card.tsx"
      via: "RosterMemberCard import"
      pattern: "RosterMemberCard"
---

<objective>
Improve teams UX: add responsive table/card layout to team roster, improve Edit Skills dialog labeling, and remove quantity_needed from position forms.

Purpose: Close Gap 3 (table layout on desktop), Gap 4 (confusing Edit Skills UX), and Gap 6 (unnecessary quantity field) from UAT.
Output: Better team management UX with clear labeling, responsive layouts, and simplified position forms.
</objective>

<execution_context>
@/Users/chungweijian/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chungweijian/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@app/(app)/team-roster/page.tsx
@components/teams/roster-member-card.tsx
@components/teams/team-member-list.tsx
@components/teams/position-manager.tsx
@lib/teams/schemas.ts
@lib/teams/actions.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add responsive table layout to team roster page</name>
  <files>app/(app)/team-roster/page.tsx, components/teams/roster-member-card.tsx</files>
  <action>
    **In `app/(app)/team-roster/page.tsx`:**
    1. Import `Table`, `TableBody`, `TableCell`, `TableHead`, `TableHeader`, `TableRow` from `@/components/ui/table`.
    2. Import `Avatar`, `AvatarFallback`, `AvatarImage` from `@/components/ui/avatar`.
    3. Import `Crown` from `lucide-react`.
    4. Replace the member grid section with a responsive layout:
       - **Desktop (md+):** A `<Table>` with columns: Member (avatar + name + email), Teams (team badges), Positions (position/skill chips). Each row is a `<Link>` wrapping a `<TableRow>` that navigates to `/members/{id}`. Use `hidden md:block` wrapper.
       - **Mobile:** Keep existing card grid with `RosterMemberCard`, wrapped in `md:hidden`.
    5. Add a helper function `getInitials(name: string)` at the top of the file (or inline).
    6. The desktop table rows should show:
       - Column 1 (Member): Avatar (small) + full_name + email below in muted text. If lead on any team, show crown icon.
       - Column 2 (Teams): Team badges with color accent (same style as card).
       - Column 3 (Positions): Position/proficiency badges (same style as card).
    7. Make entire row clickable with `<Link>` wrapping or use `onClick` with router.push.

    **Keep `components/teams/roster-member-card.tsx` unchanged** — it's still used for mobile layout.
  </action>
  <verify>
    Run `pnpm build` — no TypeScript errors. Verify the page renders table on desktop widths and cards on mobile.
  </verify>
  <done>
    Team roster page shows responsive table on desktop (md+) and card grid on mobile, matching the ym-attend-4 pattern the user prefers.
  </done>
</task>

<task type="auto">
  <name>Task 2: Improve Edit Skills dialog UX and remove quantity_needed from positions</name>
  <files>components/teams/team-member-list.tsx, components/teams/position-manager.tsx, lib/teams/schemas.ts, lib/teams/actions.ts</files>
  <action>
    **Gap 4 — Edit Skills UX in `components/teams/team-member-list.tsx`:**
    1. In the `SkillEditDialog` component, update the dialog title and description:
       - Title: `"Assign Positions — {member.full_name}"` (instead of "Edit Skills")
       - Description: `"For each position in this team, set how experienced this member is (proficiency) and how much they want to serve in this role (preference)."`
    2. Add helper text above each position's dropdowns. For each position row, add a small section label:
       - The position name as a bold label (already exists).
       - Under each dropdown, add `<FormDescription>` or small text:
         - Proficiency select: label it `"Experience Level"` instead of just showing the placeholder. Add a `<p className="text-xs text-muted-foreground mt-0.5">` below: `"How skilled is this member at this position?"`
         - Preference select: label it `"Willingness"` instead of just showing the placeholder. Add small text: `"How much does this member want to serve here?"`
    3. Rename the dropdown menu item from `"Edit Skills"` to `"Assign Positions"` in the `MemberActions` component (the `DropdownMenuItem` that opens the skill dialog).

    **Gap 6 — Remove quantity_needed from `components/teams/position-manager.tsx`:**
    1. In `AddPositionForm`: Remove the "Qty Needed" input field and the `quantityNeeded` state. Don't pass `quantityNeeded` to `createPosition()` (let it default in schema/DB).
    2. Change the grid from `sm:grid-cols-3` to `sm:grid-cols-2` (only Name + Category remain).
    3. In `EditPositionForm`: Remove the quantity input field and `quantityNeeded` state. Don't pass `quantityNeeded` to `updatePosition()`.
    4. Change the edit form grid from `sm:grid-cols-3` to `sm:grid-cols-2`.
    5. In `PositionRow`: Remove the `Qty: {position.quantity_needed}` display text.

    **In `lib/teams/schemas.ts`:**
    1. In `createPositionSchema`: Remove `quantityNeeded` field entirely, or make it optional with a default. Since the DB column likely has a default of 1, just remove it from the schema.
    2. In `updatePositionSchema`: Remove `quantityNeeded` field.

    **In `lib/teams/actions.ts`:**
    1. In `createPosition()`: Remove `quantity_needed: parsed.data.quantityNeeded` from the insert object. The DB column default (1) will be used.
    2. In `updatePosition()`: Remove the `if (fields.quantityNeeded !== undefined)` mapping line.
  </action>
  <verify>
    Run `pnpm build` — no TypeScript errors. Verify:
    - Skill dialog shows "Assign Positions" title with explanatory text for proficiency and preference.
    - Position add/edit forms have only Name and Category fields (no quantity).
    - Position rows don't show "Qty: N" text.
  </verify>
  <done>
    Edit Skills dialog is renamed to "Assign Positions" with clear explanations of proficiency and preference. Position forms no longer show quantity_needed field.
  </done>
</task>

</tasks>

<verification>
1. `pnpm build` completes without errors
2. Team roster page (/team-roster) shows table on desktop, cards on mobile
3. "Edit Skills" menu item renamed to "Assign Positions" with better dialog UX
4. Position create/edit forms show only Name and Category (no quantity)
5. Position rows display name and category badge only (no "Qty: N")
</verification>

<success_criteria>
- Team roster uses responsive table/card layout
- Skill assignment dialog has clear, understandable labeling
- Quantity field removed from position management
- No build errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-teams-and-member-profiles/02-06-SUMMARY.md`
</output>
